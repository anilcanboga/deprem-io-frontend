<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gıda İhtiyaç Formu | Deprem İmece Platformu</title>
    <link rel="stylesheet" href="/assets/css/app.css?v=1">
</head>

<body>
    <header>
        <div class="container">
            <a href="/" class="logo" title="Deprem İmece Platformu">
                <img src="/assets/images/logo.svg" alt="Deprem İmece Platformu" width="150">
            </a>
            <nav class="nav">
                <ul>
                    <li>
                        <div class="share-button-wrapper">
                            <div class="share-title">Paylaş</div>
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="rgba(44, 46, 60, 1)" aria-hidden="true">
                                <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"></path>
                            </svg>
                            <div class="share-menu-wrapper">
                                <ul>
                                    <li>
                                        <a target="_blank" href="https://www.addtoany.com/add_to/email?linkurl=https%3A%2F%2Fdeprem.io&linkname=Yard%C4%B1m%20iste%20%26%20yard%C4%B1m%20sa%C4%9Fla.%20Deprem%20%C4%B0mece%20Platformu%20-%20deprem.io&linknote=">
                                            <img src="/assets/images/share/mail.svg" alt="deprem-io-mail">
                                        </a>
                                    </li>
                                    <li>
                                        <a target="_blank" rel="nofollow noopener" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdeprem.io&t=Yard%C4%B1m%20iste%20%26%20yard%C4%B1m%20sa%C4%9Fla.%20Deprem%20%C4%B0mece%20Platformu%20-%20deprem.io&quote=', 'newwindow', 'width=300,height=250'); return false;">
                                            <img src="/assets/images/share/facebook.svg" alt="deprem-io-facebook">
                                        </a>
                                    </li>
                                    <li>
                                        <a target="_blank" onclick="window.open('https://twitter.com/intent/tweet?text=Yard%C4%B1m%20iste%20%26%20yard%C4%B1m%20sa%C4%9Fla.%20Deprem%20%C4%B0mece%20Platformu%20-%20deprem.io%20https%3A%2F%2Fdeprem.io&related=AddToAny,micropat', 'newwindow', 'width=300,height=250'); return false;">
                                            <img src="/assets/images/share/twitter.svg" alt="deprem-io-twitter">
                                        </a>
                                    </li>
                                    <li>
                                        <a target="_blank" onclick="window.open('https://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fdeprem.io&linkname=Yard%C4%B1m%20iste%20%26%20yard%C4%B1m%20sa%C4%9Fla.%20Deprem%20%C4%B0mece%20Platformu%20-%20deprem.io&linknote=', 'newwindow', 'width=300,height=250'); return false;">
                                            <img src="/assets/images/share/linkedin.svg" alt="deprem-io-linkedin">
                                        </a>
                                    </li>
                                    <li>
                                        <a target="_blank" onclick="window.open('https://www.addtoany.com/add_to/tumblr?linkurl=https%3A%2F%2Fdeprem.io&linkname=Yard%C4%B1m%20iste%20%26%20yard%C4%B1m%20sa%C4%9Fla.%20Deprem%20%C4%B0mece%20Platformu%20-%20deprem.io&linknote=', 'newwindow', 'width=300,height=250'); return false;">
                                            <img src="/assets/images/share/tumblr.svg" alt="deprem-io-tumblr">
                                        </a>
                                    </li>
                                    <li>
                                        <a target="_blank" href="https://www.reddit.com/submit?url=https%3A%2F%2Fdeprem.io&title=Yard%C4%B1m%20iste%20%26%20yard%C4%B1m%20sa%C4%9Fla.%20Deprem%20%C4%B0mece%20Platformu%20-%20deprem.io">
                                            <img src="/assets/images/share/reddit.svg" alt="deprem-io-reddit">
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </li>
                    <li>
                        <a href="/yararli-linkler.html">Yararlı Linkler</a>
                    </li>
                    <li>
                        <a href="/iletisim.html">İletişim</a>
                    </li>

                </ul>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <section>
                <a href="/" class="back-button">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="rgba(71, 101, 255, 1)" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18">
                        </path>
                    </svg>
                    Geri
                </a>
                <h1>Gıda İhtiyaç Formu</h1>
                <div class="form">
                    <div style="background-color: #2C2E3C4D;  padding: 10px; border-radius: 10px;">
                        <div style="display: inline-flex; align-items: center; justify-content: space-between;">
                          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="rgba(255, 181, 70, 1)" style="width: 30px; height: 30px; flex-shrink: 0;"> 
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"/>
                          </svg>
                            <small style="margin-left: 10px; color: white;">
                                Eğer bu yardım talebini daha önce gönderdiysen lütfen tekrar gönderme. 
                                Kayıtlarda kopya bilgi olması kurtarma operasyonlarını olumsuz etkiler.
                            </small>
                            <div>
                                <a href="/yardim-istekleri/gida.html" class="warning-link">Mevcut&nbsp;Kayıtlar</a>
                            </div>
                        </div>
                      </div>                      
                    <br>
                    <small>* İle başlayan alanlar zorunludur.</small>

                    <form id="gidaForm">
                        <input type="text" name="yardimTipi" value="gida" style="display: none;" readonly>
                        <input type="text" name="yardimDurumu" value="bekleniyor" style="display: none;" readonly>
                        <div class="form-row form-col-3">
                            <div class="form-col">
                                <label for="adSoyad" class="redHeader">* İsim & Soyisim:</label>
                                <input type="text" class="form-control  " id="adSoyad" name="adSoyad"
                                    placeholder="* İsim & Soyisim" required>
                            </div>
                            <div class="form-col">
                                <label for="email">Email:</label>
                                <input type="email" class="form-control" id="email" name="email" placeholder="Email">
                            </div>
                            <div class="form-col">
                                <label for="telefon">Telefon:</label>
                                <input type="tel" class="form-control" id="telefon" name="telefon"
                                    placeholder="Telefon">
                            </div>
                        </div>
                        <div class="form-row form-col-3" id="yedekTelefonlar" style="align-items: center;">
                            <a href="javascript: void 0" id="ekTelefonLinki" onclick="addExtraPhone()" class="plus-button">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16" id="IconChangeColor">
                                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" id="plusIcon" fill="#4765ff" />
                                </svg>
                                Başka Telefon Ekle
                            </a>
                        </div>
                        <div class="form-row">
                            <label for="kisiSayisi">Kişi Sayısı:</label>
                            <input type="text" class="form-control" id="kisiSayisi" name="kisiSayisi"
                                placeholder="Kişi Sayısı">
                        </div>
                        <div class="form-row">
                            <label for="adres" class="redHeader">* Adres:</label>
                            <input type="text" class="form-control  " id="adres" name="adres" placeholder="* Adres"
                                required>
                        </div>
                        <div class="form-row">
                            <label for="adres-tarifi">Adres Tarifi:</label>
                            <input type="text" class="form-control" id="adres-tarifi" name="adres-tarifi"
                                placeholder="Adres Tarifi">
                        </div>
                        <div class="form-row form-col-auto">
                            <div class="form-col" style="width: 100px;">
                                <div class="form-row">
                                    <label>
                                        Aciliyet:
                                    </label>
                                </div>
                                <div class="form-row">
                                    <label for="kritik">
                                        <input type="radio" id="kritik" name="acilDurum" value="kritik">
                                        Kritik
                                    </label>
                                </div>
                                <div class="form-row">
                                    <label for="orta">
                                        <input type="radio" id="orta" name="acilDurum" value="orta" checked>
                                        Orta
                                    </label>
                                </div>
                                <div class="form-row">
                                    <label for="normal">
                                        <input type="radio" id="normal" name="acilDurum" value="normal">
                                        Normal
                                    </label>
                                </div>
                            </div>
                            <div class="form-col">
                                <label for="fizikiDurum" class="redHeader">* Fiziki Durum Hakkında Bilgi:</label>
                                <textarea class="form-control  " name="fizikiDurum" id="fizikiDurum" cols="30" rows="4"
                                    placeholder="* Fiziki Durum Hakkında Bilgi" required></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <label for="tweetLink">Tweet Linki:</label>
                            <input type="text" class="form-control" id="tweetLink" name="tweetLink" placeholder="Tweet Linki">
                        </div>
                        <div class="form-col">
                            <div class="form-row">
                                <label for="arac-var">
                                    <input type="radio" id="arac-var" name="fields-aracDurumu" value="var">
                                    Aracım var, yardımı kendim teslim alabilirim.
                                </label>
                            </div>
                            <div class="form-row">
                                <label for="arac-yok">
                                    <input type="radio" id="arac-yok" name="fields-aracDurumu" value="yok" checked>
                                    Aracım yok, yardımın teslim edilmesi gerek.
                                </label>
                            </div>
                        </div>
                        <div class="form-row">
                            <label for="kvkk" class="checkbox">
                                <input type="checkbox" id="kvkk" name="fields-kvkk" required>
                                * Form dolduran kişiden hukuki beyan: Enkaz, yıkım, yardım ve destek ihtiyaçları
                                konusunda verdiğim bilgilerin doğru ve teyit edilmiş olduğunu, bilgi kirliliği ve yanlış
                                uygulamalara yol açmamak için gerekli tüm önlem ve tedbirleri aldığımı, vermiş olduğum
                                bilgilerde meydana gelen değişiklik ve güncellemeleri bildireceğimi kabul ve beyan
                                ederim.
                            </label>
                        </div>
                        <div>
                            <button type="submit">
                                Gönder
                            </button>
                        </div>
                    </form>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <nav class="nav">
                <ul>
                    <li>
                        <a href="/yararli-linkler.html">Yararlı Linkler</a>
                    </li>
                    <li>
                        <a href="/iletisim.html">İletişim</a>
                    </li>
                    <li>
                        <a href="/legal/cerez-politikasi.html">Çerez Politikası</a>
                    </li>
                    <li>
                        <a href="/legal/gizlilik-sozlesmesi.html">Gizlilik Sözleşmesi</a>
                    </li>
                    <li>
                        <a href="/legal/aydinlatma-ve-acik-riza-metni.html">Aydınlatma Metni</a>
                    </li>
                </ul>
            </nav>
            <p class="info-title">
                Kişisel Verilerin İşlenmesine İlişkin Aydınlatma:
            </p>
            <p>
                Bu uygulama, 6 Şubat 2023 tarihinde Türkiye’de meydana gelen büyük deprem felaketinde, arama kurtarma
                çalışmaları ile yardım ve destek taleplerini ortak bir veri tabanında toplayarak yetkili kurum ve
                kuruluşlara aktarmak amacı ile bilişim teknolojileri alanında çalışan gönüllüler tarafından
                oluşturulmuştur.
                Yardım ya da desteğe ihtiyacı olduğunu belirttiğiniz kişilerin kişisel verileri ‘’Fiili imkânsızlık
                nedeniyle rızasını açıklayamayacak durumda bulunan veya rızasına hukuki geçerlilik tanınmayan kişinin
                kendisinin ya da bir başkasının hayatı veya beden bütünlüğünün korunması için zorunlu olması’’ hukuki
                sebebine dayanarak, otomatik yollarla işlenecektir. Tarafınıza ait kişisel veriler, ‘’Bir hakkın tesisi,
                kullanılması veya korunması için veri işlemenin zorunlu olması’’ hukuki sebebine dayanarak işlenecektir.
            </p>
            <p>
                Paylaşacağınız yardım, destek taleplerinde yer alan isim, soy isim, telefon ve adres gibi kişisel
                veriler, veli, vasi, temsilci bilgisi, medeni durum ve sağlık bilgileri tarafımızca oluşturulan ve
                sunucuları yurtiçi ve yurtdışında bulunan veri tabanında toplanarak, Afad, Akut, Kızılay gibi yetkili
                arama kurtarma kuruluşlarının yanı sıra destek ve yardım taleplerini karşılayabilecek sivil toplum
                kuruluşları ile kişisel veri işleme amacı ile sınırlı olarak paylaşılacaktır.
            </p>
            <p>
                Bu platform kar amacı gütmeden imece usulu bilgi paylaşımı için geliştirildi, hiçbir kurum ve kuruluşla
                ilişiği yoktur.
            </p>
            <p>
                Gerektiğinde yetkili merci ve kurumlara bilgi sağlanabilir ve işbirliği yapılabilir.
            </p>
            <p>
                Deprem İmece Platformu © 2023
            </p>
        </div>
    </footer>
    <script src="assets/js/app.js?v=1"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.1/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.1/dist/sweetalert2.min.css" rel="stylesheet">
    <script>
        var form = document.getElementById('gidaForm');
        form.onsubmit = function (event) {
            var xhr = new XMLHttpRequest();

            let phoneNum = form.telefon.value;
            phoneNum = phoneNum.replace(/\s/g, '');

            if (phoneNum.charAt(0) === "0") {
                phoneNum = phoneNum.slice(1);
            }

            if (phoneNum.length !== 10 || phoneNum.charAt(0) !== "5") {
                Swal.fire({
                    title: 'Hata!',
                    text: 'Geçerli bir telefon numarası giriniz ya da boş bırakınız !',
                    icon: 'error',
                    confirmButtonText: 'Tamam'
                });
                return false;
            } else {
                form.telefon.value = phoneNum;
            }

            var formData = new FormData(form);

            //open the request
            xhr.open('POST', 'https://deprem-27jjydhzba-ew.a.run.app/yardim')
            xhr.setRequestHeader("Content-Type", "application/json");

            // prepare the data
            const postData = Object.fromEntries(formData);
            postData.yedekTelefonlar = [];
            Object.keys(postData).forEach(key => {
                if (key.includes('yedekTelefon_')) {
                    postData.yedekTelefonlar.push(postData[key]);
                    delete postData[key];
                }
            });

            //send the form data
            xhr.send(JSON.stringify(postData));

            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    var status = xhr.status;
                    var responseBody = (JSON.parse(xhr.responseText) || {});

                    // The request has been completed successfully
                    if (status === 0 || (status >= 200 && status < 400)) {
                        Swal.fire({
                            position: 'center',
                            icon: 'success',
                            title: responseBody.message || 'Yardım talebiniz başarıyla alındı',
                            showConfirmButton: false,
                            timer: 2500
                        }).then(function() {
                         window.location.href = "/yardim-istekleri/gida.html";
                        });

                        form.reset();
                    } else {
                        Swal.fire({
                            title: 'Hata!',
                            text: responseBody.error || 'Hata Oluştu Tekrar deneyiniz !',
                            icon: 'error',
                            confirmButtonText: 'Tamam'
                        });
                    }
                }
            };

            return false;
        }

        let extraPhoneCount = 0;
        function addExtraPhone() {
            ++extraPhoneCount;
            const lnkEl = document.getElementById('ekTelefonLinki');

            if (extraPhoneCount === 3) {
                lnkEl.style.display = 'none';
            } else if (extraPhoneCount > 3) {
                return;
            }

            const div = document.createElement('div');
            const inputId = 'yedekTelefon_' + extraPhoneCount;
            div.className = 'form-col';
            div.innerHTML = '<label for="' + inputId + '">Telefon (' + (extraPhoneCount + 1) + '):</label>' +
                            '<input type="tel" class="form-control" id="' + inputId + '" name="' + inputId + '" placeholder="Telefon">';
            document.getElementById('yedekTelefonlar').insertBefore(div, lnkEl);
            document.getElementById(inputId).focus();
        }
    </script>
</body>

</html>
